
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>附录 1 applyMiddleware 与常用中间件 · 平安蜀黍的前端教程</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="marion.lau@foxmail.com">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-copyright/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../assets/style.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="devtools.html" />
    
    
    <link rel="prev" href="container.fun.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    第一单元 开发环境与工具封装
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../unit1/operatingEnvironment.html">
            
                <a href="../unit1/operatingEnvironment.html">
            
                    
                    第一课 开发环境配置
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../unit1/powershell.html">
            
                <a href="../unit1/powershell.html">
            
                    
                    附录 1 Windows 下安装 PowerShell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../unit1/iterm.html">
            
                <a href="../unit1/iterm.html">
            
                    
                    附录 2 OSX 下安装 Iterm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../unit1/vscode.html">
            
                <a href="../unit1/vscode.html">
            
                    
                    附录 3 vscode 常用插件与使用
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../unit1/webpack.html">
            
                <a href="../unit1/webpack.html">
            
                    
                    第二课 什么是 Webpack
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../unit1/modular.html">
            
                <a href="../unit1/modular.html">
            
                    
                    附录 1 什么是模块化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../unit1/npm.html">
            
                <a href="../unit1/npm.html">
            
                    
                    附录 2 使用 Npm 管理项目依赖
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../unit1/optimize.html">
            
                <a href="../unit1/optimize.html">
            
                    
                    附录 3 使用 Webpack 优化项目
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../unit1/customizeCra.html">
            
                <a href="../unit1/customizeCra.html">
            
                    
                    第三课 CRA 与 Customize-cra
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../unit1/craco.html">
            
                <a href="../unit1/craco.html">
            
                    
                    附录 1 Craco 配置文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../unit1/vite.html">
            
                <a href="../unit1/vite.html">
            
                    
                    附录 2 Vite 配置文件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../unit1/git.html">
            
                <a href="../unit1/git.html">
            
                    
                    第四课 什么是 Git
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../unit1/gitFlow.html">
            
                <a href="../unit1/gitFlow.html">
            
                    
                    附录 1 Git 工作流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../unit1/gitQuery.html">
            
                <a href="../unit1/gitQuery.html">
            
                    
                    附录 2 Git 常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../unit1/gitCommand.html">
            
                <a href="../unit1/gitCommand.html">
            
                    
                    附录 3 Git 命令集
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../unit1/codingStandard.html">
            
                <a href="../unit1/codingStandard.html">
            
                    
                    第五课 代码规范
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="../unit1/eslint.html">
            
                <a href="../unit1/eslint.html">
            
                    
                    附录 1 ESLint
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../unit1/utilsPackage.html">
            
                <a href="../unit1/utilsPackage.html">
            
                    
                    第六课 小工具封装
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../unit1/th.md">
            
                <span>
            
                    
                    附录 1 完整的防抖
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../unit1/storageManage.html">
            
                <a href="../unit1/storageManage.html">
            
                    
                    附录 2 Storage 管理工具
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../unit1/axiosPackage.html">
            
                <a href="../unit1/axiosPackage.html">
            
                    
                    第七课 封装 Axios
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../unit1/fetch.html">
            
                <a href="../unit1/fetch.html">
            
                    
                    附录 1 Fetch 原码解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="../unit1/axios.html">
            
                <a href="../unit1/axios.html">
            
                    
                    附录 2 Axios 原码解析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    第二单元 React 基础与关联知识
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="jsx.html">
            
                <a href="jsx.html">
            
                    
                    第一课 JSX 与虚拟 DOM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="soundStructure.html">
            
                <a href="soundStructure.html">
            
                    
                    附录 1 react 源码结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="flex.html">
            
                <a href="flex.html">
            
                    
                    附录 2 flex 布局
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="diff.html">
            
                <a href="diff.html">
            
                    
                    附录 3 DIFF 与 FIBER
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="component.html">
            
                <a href="component.html">
            
                    
                    第二课 组件与状态
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="login.code.html">
            
                <a href="login.code.html">
            
                    
                    项目实战 创建登录页 UI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="useContext.html">
            
                <a href="useContext.html">
            
                    
                    附录 1 使用 Context 实现跨级组件通讯
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="setState.html">
            
                <a href="setState.html">
            
                    
                    附录 2 react setState 任务队列详解
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="antd.form.html">
            
                <a href="antd.form.html">
            
                    
                    附录 3 antd form 表单组件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="lifeCycle.html">
            
                <a href="lifeCycle.html">
            
                    
                    第三课 生命周期与组件优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="login.fun.html">
            
                <a href="login.fun.html">
            
                    
                    项目实战 完成登录页功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="componentOptimize.html">
            
                <a href="componentOptimize.html">
            
                    
                    附录 1 组件的优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="regexp.html">
            
                <a href="regexp.html">
            
                    
                    附录 2 JS 正则表达式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="reactRouter.html">
            
                <a href="reactRouter.html">
            
                    
                    第四课 路由与嵌套路由
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="container.html">
            
                <a href="container.html">
            
                    
                    项目实战 创建全局框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="communication.html">
            
                <a href="communication.html">
            
                    
                    附录 1 组件通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="omicron.html">
            
                <a href="omicron.html">
            
                    
                    附录 2 算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.4" data-path="sortAlgorithm.html">
            
                <a href="sortAlgorithm.html">
            
                    
                    附录 3 十大经典排序算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="redux.html">
            
                <a href="redux.html">
            
                    
                    第五课 全局状态管理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="productState.html">
            
                <a href="productState.html">
            
                    
                    项目实战 使用 redux 管理项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.2" data-path="container.fun.html">
            
                <a href="container.fun.html">
            
                    
                    项目实战 完善全局框架
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.5.3" data-path="middleware.html">
            
                <a href="middleware.html">
            
                    
                    附录 1 applyMiddleware 与常用中间件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.4" data-path="devtools.html">
            
                <a href="devtools.html">
            
                    
                    附录 2 调试工具与状态持久化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.5" data-path="reduxToolkit.html">
            
                <a href="reduxToolkit.html">
            
                    
                    附录 3 redux 的官方工具库 reduxToolkit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="route_auth.html">
            
                <a href="route_auth.html">
            
                    
                    第六课 路由守卫
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../unit1/globalRoutes.html">
            
                <a href="../unit1/globalRoutes.html">
            
                    
                    项目实战 配置全站路由
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="commodityManagement.md">
            
                <span>
            
                    
                    项目实战 创建商品管理页
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="../unit1/guard.md">
            
                <span>
            
                    
                    附录 2 路由表与用户权限管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.4" data-path="hoc.html">
            
                <a href="hoc.html">
            
                    
                    附录 3 高阶组件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="hooks.html">
            
                <a href="hooks.html">
            
                    
                    第七课 hooks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.7.1" data-path="commodityManagement.fun.md">
            
                <span>
            
                    
                    项目实战 实现商品管理页的功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.2" data-path="goodsAdd.md">
            
                <span>
            
                    
                    项目实战 创建商品添加页
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.3" data-path="hooksOptimize.md">
            
                <span>
            
                    
                    附录 2 hooks 组件的优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="moreHook.html">
            
                <a href="moreHook.html">
            
                    
                    第八课 更多的 hooks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="goodsAdd.fun.md">
            
                <span>
            
                    
                    项目实战 完成商品添加页功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.2" data-path="hooksRedux.md">
            
                <span>
            
                    
                    附录 1 实现全局状态管理
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="customHook.html">
            
                <a href="customHook.html">
            
                    
                    第九课 自定义 hooks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    第三单元 ECMAScript 基础知识
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../unit6/lessons_01.html">
            
                <a href="../unit6/lessons_01.html">
            
                    
                    第一课 JavaScript 常用 API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../unit6/lessons_03.html">
            
                <a href="../unit6/lessons_03.html">
            
                    
                    第二课 promise 与 async/await
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../unit6/lessons_07.html">
            
                <a href="../unit6/lessons_07.html">
            
                    
                    第三课 原型与原型链以及继承
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../unit6/lessons_09.html">
            
                <a href="../unit6/lessons_09.html">
            
                    
                    第四课 JS 事件循环
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../unit6/lessons_04.html">
            
                <a href="../unit6/lessons_04.html">
            
                    
                    第五课 Set/Map
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../unit6/lessons_05.html">
            
                <a href="../unit6/lessons_05.html">
            
                    
                    第六课 Reflect/Proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../unit6/lessons_02.html">
            
                <a href="../unit6/lessons_02.html">
            
                    
                    第七课 函数式编程的一些小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../unit6/lessons_06.html">
            
                <a href="../unit6/lessons_06.html">
            
                    
                    第八课 ES 笔试题实现
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1" data-path="../unit3/arrayToTree.md">
            
                <span>
            
                    
                    附录 1 扁平数据结构转树结构
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    第四单元 TypeScript 基础知识
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../unit9/lessons_01.html">
            
                <a href="../unit9/lessons_01.html">
            
                    
                    第一课 TypeScript 基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../unit9/lessons_02.html">
            
                <a href="../unit9/lessons_02.html">
            
                    
                    第二课 TypeScript 入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" >
            
                <span>
            
                    
                    第三课 TypeScript 泛型详解
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../unit9/lessons_03.html">
            
                <a href="../unit9/lessons_03.html">
            
                    
                    第三课 TypeScript 与类组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../unit9/lessons_04.html">
            
                <a href="../unit9/lessons_04.html">
            
                    
                    第四课 TypeScript 与函数组件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    第五单元 UMI 基于 React 的 MVC 框架
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    第六单元 React-Native
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    第七单元 了解一些 VUE
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    第八单元 uniapp 与小程序
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    第九单元 NODEJS
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    第十单元 架构入门
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    第十一单元 常见面试问题
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../unit_10/micro_frontend.md">
            
                <span>
            
                    
                    第一课 什么是微前端
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../unit_10/single_sign_on.md">
            
                <span>
            
                    
                    第二课 单点登陆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../unit_10/websocket.md">
            
                <span>
            
                    
                    第三课 websocket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../unit_10/cross_domain.md">
            
                <span>
            
                    
                    第四课 跨域问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../unit_10/use_mock.md">
            
                <span>
            
                    
                    第五课 mock 的配置与使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../unit_10/server_side_render.md">
            
                <span>
            
                    
                    第六课 什么是 ssr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../unit_10/npm_publish.md">
            
                <span>
            
                    
                    第七课 发布你的 npm 插件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    第十二单元 业务中常见的代码积累
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../unit_10/lessons_02.md">
            
                <span>
            
                    
                    lessons_02. 第三方登陆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../unit_10/lessons_03.md">
            
                <span>
            
                    
                    lessons_03. 微信支付
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../unit_10/lessons_03.md">
            
                <span>
            
                    
                    lessons_04. 微信支付
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    其它附件
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../enclusore/install-iterm.html">
            
                <a href="../enclusore/install-iterm.html">
            
                    
                    Terminal 配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../enclusore/tech-scheme.html">
            
                <a href="../enclusore/tech-scheme.html">
            
                    
                    项目技术方案
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../enclusore/cross-domin.md">
            
                <span>
            
                    
                    跨域
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="../enclusore/react-source.html">
            
                <a href="../enclusore/react-source.html">
            
                    
                    React 原码
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >附录 1 applyMiddleware 与常用中间件</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <blockquote>
<p>&#x5E73;&#x5B89;&#x8700;&#x9ECD;&#x7684;&#x524D;&#x7AEF;&#x6559;&#x7A0B; &gt; Redux &#x5FC5;&#x5B66;&#x77E5;&#x8BC6;&#x70B9; &gt; redux &#x4E2D;&#x95F4;&#x4EF6;&#x4E0E; applyMiddleware</p>
</blockquote>
<h3 id="redux-&#x4E2D;&#x95F4;&#x4EF6;&#x662F;&#x4EC0;&#x4E48;">redux &#x4E2D;&#x95F4;&#x4EF6;&#x662F;&#x4EC0;&#x4E48;</h3>
<p>redux &#x672C;&#x8EAB;&#x63D0;&#x4F9B;&#x4E86;&#x5F88;&#x5F3A;&#x5927;&#x7684;&#x6570;&#x636E;&#x6D41;&#x7BA1;&#x7406;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x8FD9;&#x5E76;&#x4E0D;&#x662F;&#x5B83;&#x552F;&#x4E00;&#x7684;&#x5F3A;&#x5927;&#x4E4B;&#x5904;&#xFF0C;&#x4E3A;&#x4E86;&#x964D;&#x4F4E;&#x8026;&#x5408;&#x6027;&#x51CF;&#x5C11;&#x5B83;&#x81EA;&#x8EAB;&#x7684;&#x4EE3;&#x7801;&#x91CF;&#xFF0C;&#x5B83;&#x629B;&#x5F03;&#x4E86;&#x5F53;&#x524D;&#x4E00;&#x4E9B;&#x6D41;&#x884C;&#x5E93;&#x7684;&#x5927;&#x800C;&#x5168;&#x7684;&#x4F5C;&#x6CD5;&#xFF0C;&#x53EA;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x6700;&#x57FA;&#x7840;&#x7684;&#x6570;&#x636E;&#x6D41;&#x7BA1;&#x7406;&#xFF0C;store.dispatch &#x6240;&#x80FD;&#x63A5;&#x53D7;&#x7684; action &#x53EA;&#x5141;&#x8BB8;&#x662F;&#x4E00;&#x4E2A; JavaScript &#x5BF9;&#x8C61;&#xFF0C;&#x5148;&#x770B;&#x6E90;&#x7801;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x51FD;&#x6570;&#x8FD0;&#x884C;&#x7684;&#x7B2C;&#x4E00;&#x4EF6;&#x4E8B;&#x5C31;&#x662F;&#x5224;&#x65AD;&#x4F20;&#x5165;&#x7684;action&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5BF9;&#x8C61;</span>
  <span class="token comment">// isPlainObject&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x5224;&#x65AD;&#x53C2;&#x6570;&#x662F;&#x5426;&#x4E3A;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x63D0;&#x793A;&#x4F60;&#xFF0C;&#x4F20;&#x5165;&#x7684;action&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5BF9;&#x8C61;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Actions must be plain objects. Instead, the actual type was: &apos;&quot;</span> <span class="token operator">+</span>
        <span class="token function">kindOf</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token operator">+</span>
        <span class="token string">&quot;&apos;. You may need to add middleware to your store setup to handle dispatching other values, such as &apos;redux-thunk&apos; to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x8FD9;&#x91CC;&#x4E5F;&#x662F;&#xFF0C;&#x6240;&#x6709;&#x7684;action&#x5BF9;&#x8C61;&#x5FC5;&#x987B;&#x6709;type&#x5C5E;&#x6027;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&apos;undefined&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token string">&apos;Actions may not have an undefined &quot;type&quot; property. You may have misspelled an action type string constant.&apos;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x540C;&#x4E00;&#x65F6;&#x95F4;&#x53EA;&#x5141;&#x8BB8;&#x53D1;&#x751F;&#x4E00;&#x4E2A;dispatch&#x64CD;&#x4F5C;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDispatching<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&apos;Reducers may not dispatch actions.&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x5C1D;&#x8BD5;&#x4F7F;&#x7528;reducer&#x51FD;&#x6570;&#x53BB;&#x4FEE;&#x6539;state</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    isDispatching <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728;&#x521B;&#x5EFA;store&#x65F6;&#x4F7F;&#x7528;&#x4E86;combineReducers&#x65B9;&#x6CD5;&#x5408;&#x5E76;&#x6240;&#x6709;&#x7684;reducer&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x6839;&#x636E;compose&#x89C4;&#x5219;&#xFF0C;&#x8FD9;&#x91CC;&#x4F1A;&#x4ECE;&#x5916;&#x5230;&#x5185;&#x9010;&#x4E2A;&#x6267;&#x884C;&#x6240;&#x6709;&#x7684;reducer</span>
    currentState <span class="token operator">=</span> <span class="token function">currentReducer</span><span class="token punctuation">(</span>currentState<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token comment">// finally&#x533A;&#x5757;&#x7684;&#x4EE3;&#x7801;&#x8868;&#x793A;&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x90FD;&#x4F1A;&#x6267;&#x884C;</span>
    <span class="token comment">// &#x4FEE;&#x6539;&#x5B8C;&#x6210;&#x540E;</span>
    isDispatching <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x901A;&#x8FC7;&#x6E90;&#x7801;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E86; dispatch &#x53EA;&#x80FD;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x5B83;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x6709;&#x7279;&#x6B8A;&#x9700;&#x6C42;&#x4E86;&#x8981;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;&#x6BD4;&#x5982;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x652F;&#x6301;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x6216;&#x4F20;&#x5165;&#x67D0;&#x4E2A;&#x51FD;&#x6570;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// &#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x56E0;&#x4E3A;Dispatch&#x4E0D;&#x80FD;&#x63A5;&#x53D7;&#x975E;Object&#x7C7B;&#x578B;&#x7684;&#x503C;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> vlaue <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x903B;&#x8F91;&#x7B80;&#x5355;&#x65F6;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x505A;</span>
<span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> value <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// javascript&#x5728;&#x6267;&#x884C;&#x8D4B;&#x503C;&#x8868;&#x8FBE;&#x5F0F;&#x65F6;&#xFF0C;&#x4F1A;&#x5148;&#x8BA1;&#x7B97;&#x8D4B;&#x503C;&#x8868;&#x8FBE;&#x5F0F;&#x53F3;&#x8FB9;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x5B83;&#x4F1A;&#x5148;&#x5C06;multiply&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x8D4B;&#x7ED9;payload</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&apos;multiply&apos;</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> <span class="token function">multiply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5728;&#x903B;&#x8F91;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x9047;&#x4E0A;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#x7684;&#x903B;&#x8F91;&#x5462;&#xFF1F;&#x6216;&#x8005;&#x9047;&#x4E0A;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;redux &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A; applyMiddleware &#x65B9;&#x6CD5;&#xFF0C;&#x7528;&#x4E8E;&#x63A5;&#x53D7;&#x7B2C;&#x4E09;&#x65B9;&#x63D2;&#x4EF6;&#x6765;&#x6269;&#x5C55;&#x81EA;&#x8EAB;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x5373;&#x63D2;&#x5373;&#x7528;&#x7684;&#x6982;&#x5FF5;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// store.js</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>
<span class="token comment">// &#x8C03;&#x7528;createStore&#x65B9;&#x6CD5;&#x521B;&#x5EFA;store&#x5E93;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token comment">// &#x5E94;&#x7528;&#x4E86;&#x4E2D;&#x95F4;&#x4EF6;&#x4EE5;&#x540E;&#xFF0C;&#x8FD9;&#x6837;&#x6D3E;&#x53D1;action&#x5C31;&#x4E0D;&#x4F1A;&#x62A5;&#x9519;&#x4E86;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&apos;multiply&apos;</span><span class="token punctuation">,</span> <span class="token function-variable function">payload</span><span class="token operator">:</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> vlaue <span class="token operator">*</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x6240;&#x4EE5;&#xFF0C;applyMiddlerware &#x662F;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x5C31;&#x662F; redux &#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x63A5;&#x53D7;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x6765;&#x5904;&#x7406; action &#x7684;&#x63A5;&#x53E3;&#x3002;&#x800C;&#x4E2D;&#x95F4;&#x4EF6;&#x5C31;&#x662F;&#x8FD9;&#x7C7B;&#x7684;&#x5916;&#x90E8;&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528; applyMiddleware &#x65B9;&#x6CD5;&#x5BF9; action &#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x540E;&#x518D;&#x91CD;&#x65B0;&#x6D3E;&#x53D1;&#x5230; store&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x8BA9; redux &#x652F;&#x6301;&#x81EA;&#x8EAB;&#x4EE5;&#x5916;&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<h3 id="&#x89E3;&#x6790;-applymiddleware">&#x89E3;&#x6790; applyMiddleware</h3>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x5730;&#x7406;&#x89E3;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x8FD0;&#x884C;&#x673A;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B; redux &#x76F8;&#x5173;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x56E0;&#x4E3A;&#x539F;&#x7801;&#x90FD;&#x662F; typeScript &#x683C;&#x5F0F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x770B; javaScript &#x683C;&#x5F0F;&#x7684;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x8FDB;&#x5230; dist &#x76EE;&#x5F55;&#x4E0B;&#xFF1A;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x770B;&#x770B; createStore &#x4E0E; applyMiddleware &#x76F8;&#x5173;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x4E86;&#x89E3; redux &#x4E2D;&#x589E;&#x5F3A;&#x5668;&#x662F;&#x600E;&#x6837;&#x6267;&#x884C;&#x7684;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">/**
 * createStore&#x63A5;&#x53D7;&#x7684;3&#x4E2A;&#x53C2;&#x6570;
 * @param {Function} reducer &#x7528;&#x4E8E;&#x5904;&#x7406;action&#x7684;&#x51FD;&#x6570;
 * @param {Object} preloadedState &#x53EF;&#x9009;&#x7684;&#x521D;&#x59CB;store&#x5C5E;&#x6027;&#x53C2;&#x6570;
 * @param {Function} enhance &#x589E;&#x5F3A;&#x5668;&#x51FD;&#x6570;
 * @returns &#x7ECF;&#x8FC7;enhance&#x589E;&#x5F3A;&#x540E;&#x7684;createStore&#x51FD;&#x6570;
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token parameter">reducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">,</span> enhance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x4E0D;&#x5141;&#x8BB8;&#x4F20;&#x5165;3&#x4E2A;&#x4EE5;&#x4E0A;&#x53C2;&#x6570;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token keyword">typeof</span> preloadedState <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> enhancer <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span><span class="token keyword">typeof</span> enhancer <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> arguments<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x8FD9;&#x6BB5;&#x63D0;&#x793A;&#x7684;&#x610F;&#x601D;&#x662F;&#x4E0D;&#x8981;&#x540C;&#x65F6;&#x4F20;&#x5165;&#x5F88;&#x591A;&#x4E2A;&#x589E;&#x5F3A;&#x5668;&#xFF0C;&#x800C;&#x662F;&#x5C06;&#x5B83;&#x4EEC;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x4EE5;&#x540E;&#x518D;&#x4F20;&#x5165;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token string">&apos;It looks like you are passing several store enhancers to &apos;</span> <span class="token operator">+</span>
        <span class="token string">&apos;createStore(). This is not supported. Instead, compose them &apos;</span> <span class="token operator">+</span>
        <span class="token string">&apos;together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.&apos;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x5982;&#x679C;&#x53EA;&#x4F20;&#x4E86;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x4E14;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x51FD;&#x6570;&#x7C7B;&#x578B;&#x7684;&#xFF0C;&#x5C31;&#x8BA4;&#x4E3A;preloadedState&#x6CA1;&#x4F20;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> preloadedState <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> enhancer <span class="token operator">===</span> <span class="token string">&apos;undefined&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x8C03;&#x6574;&#x53C2;&#x6570;&#x7684;&#x503C;</span>
    enhancer <span class="token operator">=</span> preloadedState<span class="token punctuation">;</span>
    preloadedState <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x4F20;&#x5165;&#x589E;&#x5F3A;&#x51FD;&#x6570;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> enhancer <span class="token operator">!==</span> <span class="token string">&apos;undefined&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x5982;&#x679C;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x4E0D;&#x6B63;&#x786E;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> enhancer <span class="token operator">!==</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Expected the enhancer to be a function. Instead, received: &apos;&quot;</span> <span class="token operator">+</span>
          <span class="token function">kindOf</span><span class="token punctuation">(</span>enhancer<span class="token punctuation">)</span> <span class="token operator">+</span>
          <span class="token string">&quot;&apos;&quot;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
    &#x4F7F;&#x7528;&#x4F20;&#x5165;&#x7684;&#x589E;&#x5F3A;&#x5668;&#x589E;&#x5F3A;createStore&#x65B9;&#x6CD5;&#x540E;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x5E76;&#x8FD4;&#x56DE;&#x589E;&#x5F3A;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;&#x7ED3;&#x679C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;react&#x7684;&#x9AD8;&#x9636;&#x51FD;&#x6570;
    &#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC; enhancer &#x5C31;&#x662F; applyMiddleware &#x51FD;&#x6570;
    */</span>
    <span class="token keyword">return</span> <span class="token function">enhancer</span><span class="token punctuation">(</span>createStore<span class="token punctuation">)</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// &#x5176;&#x5B83;&#x7684;&#x4EE3;&#x7801;&#x6682;&#x65F6;&#x4E0D;&#x5173;&#x6CE8;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x4EE5;&#x8BFE;&#x540E;&#x81EA;&#x5DF1;&#x53BB;&#x770B;&#x770B;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;applyMiddleware &#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x5176;&#x5B9E;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x5224;&#x65AD;&#x5B83;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5C31;&#x628A; createStore &#x65B9;&#x6CD5;&#x548C;&#x63A5;&#x6536;&#x5230;&#x7684;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x4F20;&#x8FC7;&#x53BB;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x770B;&#x770B; applyMiddleware &#x7684;&#x6E90;&#x7801;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x901A;&#x8FC7;arguments&#x6765;&#x83B7;&#x53D6;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x904D;&#x5386;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x5C06;&#x7C7B;&#x6570;&#x7EC4;&#x7684;arguments&#x8F6C;&#x6362;&#x6210;&#x6570;&#x7EC4;&#x683C;&#x5F0F;&#x3002;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>
    <span class="token keyword">var</span> _len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> middlewares <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len<span class="token punctuation">)</span><span class="token punctuation">,</span> _key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _key <span class="token operator">&lt;</span> _len<span class="token punctuation">;</span>
    _key<span class="token operator">++</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    middlewares<span class="token punctuation">[</span>_key<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * &#x8FD9;&#x91CC;&#x8FD4;&#x56DE;&#x7684;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x521A;&#x521A;&#x770B;&#x5230;&#x7684;enhancer&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x5728;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x4F1A;&#x6536;&#x5230;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x7684;createStore&#x65B9;&#x6CD5;
   */</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createStore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x5916;&#x9762;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x6267;&#x884C;enhancer(createStore)&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5B83;&#x63A5;&#x53D7;&#x7684;&#x53C2;&#x6570;&#x662F;reducer&#x548C;preloadedState
     */</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// void&#x8868;&#x793A;&#x8BA1;&#x7B97;&#x4F46;&#x4E0D;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x8FD9;&#x91CC;&#x6267;&#x884C;&#x7684;createStore&#x7684;this&#x6307;&#x9488;&#x6307;&#x5411;&#x4E86;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5B9E;&#x9645;&#x4E0A;&#x7B49;&#x4E8E;createStore(arguments)</span>
      <span class="token comment">// &#x521B;&#x5EFA;&#x4E00;&#x4E2A;store</span>
      <span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// &#x8FD9;&#x91CC;&#x662F;&#x4E3A;&#x4E86;&#x8B66;&#x544A;middleware&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x4E0D;&#x8981;&#x5728;middleware&#x5185;&#x90E8;&#x4F7F;&#x7528;dispatch&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x8FD8;&#x6CA1;&#x6709;dispatch&#xFF0C;&#x5982;&#x679C;&#x8C03;&#x7528;&#x4F1A;&#x5BFC;&#x81F4;&#x9519;&#x8BEF;</span>
      <span class="token keyword">var</span> <span class="token function-variable function">_dispatch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
          <span class="token string">&apos;Dispatching while constructing your middleware is not allowed. &apos;</span> <span class="token operator">+</span>
            <span class="token string">&apos;Other middleware would not be applied to this dispatch.&apos;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token comment">// &#x4ECE;store&#x4E2D;&#x83B7;&#x53D6;getState&#x65B9;&#x6CD5;</span>
      <span class="token keyword">var</span> middlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>
        getState<span class="token operator">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>
        <span class="token function-variable function">dispatch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">_dispatch</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x901A;&#x8FC7;&#x6570;&#x7EC4;&#x7684;map&#x65B9;&#x6CD5;&#x6765;&#x5C06;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6240;&#x6709;&#x4E2D;&#x95F4;&#x4EF6;&#x90FD;&#x6267;&#x884C;&#x4E00;&#x904D;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x6240;&#x6709;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x91CC;&#x9762;&#x5C31;&#x90FD;&#x80FD;&#x4F7F;&#x7528;getState&#x548C;&#x4E0D;&#x53EF;&#x7528;&#x7684;dispatch&#x65B9;&#x6CD5;&#x4E86;</span>
      <span class="token keyword">var</span> chain <span class="token operator">=</span> middlewares<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">middleware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">middleware</span><span class="token punctuation">(</span>middlewareAPI<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x4F7F;&#x7528;compose&#x5C06;&#x6240;&#x6709;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x4F20;&#x5165;&#x53EF;&#x7528;&#x7684;dispatch&#xFF0C;&#x6700;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x7ECF;&#x8FC7;&#x4FEE;&#x6539;&#x7684;&#x53EF;&#x7528;&#x7684;dispatch</span>
      _dispatch <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> chain<span class="token punctuation">)</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x590D;&#x5236;&#x4E00;&#x4E2A;&#x65B0;&#x7684;store&#x5BF9;&#x8C61;&#xFF0C;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x6709;&#x5C5E;&#x6027;&#x4E3A;&#x53EF;&#x6539;&#x53D8;&#x3001;&#x53EF;&#x5220;&#x9664;&#x3001;&#x53EF;&#x679A;&#x4E3E;</span>
      <span class="token comment">// &#x8FD9;&#x5757;&#x4E0E;&#x6574;&#x4F53;&#x903B;&#x8F91;&#x6CA1;&#x6709;&#x592A;&#x5927;&#x5173;&#x7CFB;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6682;&#x65F6;&#x5FFD;&#x7565;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x4EE5;&#x8BFE;&#x540E;&#x53BB;&#x770B;&#x6E90;&#x7801;</span>
      <span class="token keyword">return</span> <span class="token function">_objectSpread2</span><span class="token punctuation">(</span>
        <span class="token function">_objectSpread2</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          dispatch<span class="token operator">:</span> _dispatch<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5176;&#x5B9E; applyMiddleware &#x6700;&#x6838;&#x5FC3;&#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F;&#x4F7F;&#x7528; compose&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x770B;&#x770B; compose &#x7684;&#x5B9E;&#x73B0;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x5C06;arguments&#x4E5F;&#x5C31;&#x662F;&#x4F20;&#x5165;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x53C2;&#x6570;&#x8F6C;&#x6362;&#x6210;&#x6570;&#x7EC4;&#x683C;&#x5F0F;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>
    <span class="token keyword">var</span> _len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> funcs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len<span class="token punctuation">)</span><span class="token punctuation">,</span> _key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _key <span class="token operator">&lt;</span> _len<span class="token punctuation">;</span>
    _key<span class="token operator">++</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    funcs<span class="token punctuation">[</span>_key<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// &#x5982;&#x679C;&#x6CA1;&#x6709;&#x4E2D;&#x95F4;&#x4EF6;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>funcs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x5982;&#x679C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>funcs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> funcs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x5C06;&#x6240;&#x6709;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x4ECE;&#x5DE6;&#x81F3;&#x53F3;&#x4F9D;&#x6B21;&#x5408;&#x5E76;&#x8D77;&#x6765;&#x6210;&#x4E00;&#x4E2A;&#x6D0B;&#x8471;&#x5708;&#x7684;&#x6837;&#x5B50;</span>
  <span class="token keyword">return</span> funcs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x4E2D;&#x95F4;&#x4EF6;&#x91CC;&#x83B7;&#x53D6;&#x5230;&#x7684;next&#x51FD;&#x6570;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x6839;&#x636E;javascript&#x7684;&#x8D4B;&#x503C;&#x8868;&#x8FBE;&#x5F0F;(&#x53C2;&#x6570;===&#x9690;&#x6027;&#x8D4B;&#x503C;)&#xFF0C;&#x5148;&#x8BA1;&#x7B97;&#x540E;&#x8D4B;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5148;&#x8C03;&#x7528;b&#x51FD;&#x6570;&#xFF0C;</span>
      <span class="token comment">// &#x5C31;&#x662F;funs&#x6570;&#x7EC4;&#x91CC;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x53C2;&#x6570;arguments&#x5219;&#x662F;next&#x51FD;&#x6570;&#x63A5;&#x6536;&#x5230;&#x7684;action</span>
      <span class="token keyword">return</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x901A;&#x8FC7;&#x5C06;&#x4E0D;&#x540C;&#x7684; middleware &#x4E00;&#x5C42;&#x5C42;&#x5730;&#x5305;&#x88F9;&#x5230;&#x539F;&#x751F;&#x7684; dispatch &#x4E0A;&#x9762;&#x6765;&#x5F62;&#x6210;&#x6240;&#x8C13;&#x7684;&#x6D0B;&#x8471;&#x5708;&#x7684;&#x5F62;&#x6001;&#xFF0C;&#x8BA9;&#x6240;&#x6709;&#x7684; Middleware &#x91CC;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A; next &#x65B9;&#x6CD5;&#xFF0C;&#x540C;&#x65F6;&#x8FD8;&#x4FDD;&#x6301;&#x4E86; store &#x7684;&#x4E00;&#x81F4;&#x6027;</p>
<h3 id="&#x81EA;&#x5B9A;&#x4E49;&#x4E2D;&#x95F4;&#x4EF6;">&#x81EA;&#x5B9A;&#x4E49;&#x4E2D;&#x95F4;&#x4EF6;</h3>
<p>&#x770B;&#x5B8C;&#x4E0A;&#x9762;&#x7684;&#x6E90;&#x7801;&#x540E;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x540C;&#x5B66;&#x89C9;&#x5F97;&#x903B;&#x8F91;&#x6709;&#x4E9B;&#x7ED5;&#xFF0C;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x634B;&#x660E;&#x767D;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x7684;&#x6574;&#x4F53;&#x601D;&#x8DEF;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">/**
 * &#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x5728;&#x88AB;&#x6267;&#x884C;&#x65F6;&#x90FD;&#x4F1A;&#x4F20;&#x5165;&#x4E00;&#x4E2A;middlewareAPI&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x5305;&#x542B;&#x6709;dispatch&#x5C5E;&#x6027;&#x548C;getState&#x5C5E;&#x6027;
 */</span>
<span class="token keyword">function</span> <span class="token function">logger</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> getState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x63A5;&#x6536;&#x4E00;&#x4E2A;next&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;next&#x5C5E;&#x6027;&#x662F;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x8BB0;&#x5F97;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x4EE5;&#x56DE;&#x60F3;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x4ECB;&#x7ECD;&#x7684;compose&#x65B9;&#x6CD5;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x51FD;&#x6570;&#x4E86;&#xFF0C;&#x5904;&#x7406;action&#x7684;&#x903B;&#x8F91;&#x90FD;&#x5728;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x91CC;&#x53BB;&#x5B8C;&#x6210;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;&#x4F20;&#x5165;&#x4E86;action:&apos;</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x5C06;action&#x4F20;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x8FDB;&#x884C;&#x5904;&#x7406;</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;&#x5904;&#x7406;&#x5B8C;&#x6210;&#x7684;state&apos;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x5E38;&#x7528;&#x4E2D;&#x95F4;&#x4EF6;&#x53CA;&#x539F;&#x7801;">&#x5E38;&#x7528;&#x4E2D;&#x95F4;&#x4EF6;&#x53CA;&#x539F;&#x7801;</h3>
<p>&#x7406;&#x89E3;&#x4E86; applyMiddleware &#x7684;&#x8FD0;&#x884C;&#x673A;&#x5236;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6765;&#x770B;&#x770B;&#x5E02;&#x9762;&#x4E0A;&#x5E38;&#x89C1;&#x7684;&#x4E00;&#x4E9B;&#x4E2D;&#x95F4;&#x4EF6;&#x4E86;&#xFF1A;</p>
<h4 id="redux-thunk">redux-thunk</h4>
<p>&#x5728; redux &#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x4E2D;&#xFF0C;redux-thunk &#x662F;&#x7528;&#x5F97;&#x6700;&#x591A;&#x7684;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#x6700;&#x5E7F;&#x7684;&#x3002;&#x5B83;&#x662F;&#x901A;&#x8FC7;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x601D;&#x60F3;&#x6765;&#x8BBE;&#x8BA1;&#x7684;&#xFF0C;&#x8BA9;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x90FD;&#x5C3D;&#x91CF;&#x5730;&#x5C0F;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x51FD;&#x6570;&#x7684;&#x5D4C;&#x5957;&#x7EC4;&#x5408;&#x6765;&#x5B9E;&#x73B0;&#x590D;&#x6742;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5B83;&#x7684;&#x5DE5;&#x4F5C;&#x673A;&#x5236;&#x76F8;&#x5BF9;&#x7B80;&#x5355;&#x5374;&#x5F88;&#x597D;&#x5730;&#x89E3;&#x51B3;&#x4E86;&#x5E73;&#x65F6;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x4E2D;&#x7684;&#x5F02;&#x6B65;&#x95EE;&#x9898;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">/**
 * &#x521B;&#x5EFA;redux-thunk&#x4E3B;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x6CD5;
 * @param {Object} extraArgument &#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;
 * &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x5E94;&#x7528;redux-thunk&#x65F6;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5E94;&#x7528;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;createThunkMiddleware&#x6765;&#x914D;&#x7F6E;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x53C2;&#x6570;&#x540E;&#x518D;&#x5E94;&#x7528;
 */</span>
<span class="token keyword">function</span> <span class="token function">createThunkMiddleware</span><span class="token punctuation">(</span><span class="token parameter">extraArgument</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x6267;&#x884C;createThunkMiddleware&#x540E;&#x8FD4;&#x56DE;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x51FD;&#x6570;&#x5E76;&#x5229;&#x7528;&#x95ED;&#x5305;&#x7684;&#x539F;&#x7406;&#x7F13;&#x5B58;&#x4E86;extraArgument&#x53C2;&#x6570;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> getState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token comment">// dispatch&#x8C03;&#x7528;&#x6216;&#x6D0B;&#x8471;&#x5708;&#x5916;&#x5C42;&#x51FD;&#x6570;&#x8C03;&#x7528;</span>
    <span class="token parameter">next</span> <span class="token operator">=&gt;</span>
    <span class="token comment">// &#x63A5;&#x6536;&#x5230;action&#x5BF9;&#x8C61;</span>
    <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x5982;&#x679C;action&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5219;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &#x6211;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x5230;&#x7684;&#x53C2;&#x6570;&#xFF1A;dispatch, getState, &#x4EE5;&#x53CA;&#x4E0A;&#x9762;&#x5B9A;&#x4E49;&#x7684;&#x989D;&#x5916;&#x53C2;&#x6570;</span>
        <span class="token keyword">return</span> <span class="token function">action</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">,</span> extraArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// &#x5426;&#x5219;&#x8F6C;&#x4EA4;&#x7ED9;&#x6D0B;&#x8471;&#x5708;&#x66F4;&#x5185;&#x5C42;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x8FDB;&#x884C;&#x8FD0;&#x7B97;&#x5E76;&#x5C06;&#x8FD0;&#x7B97;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x4E0A;&#x4E00;&#x5C42;&#x51FD;&#x6570;&#x6216;dispatch</span>
      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// &#x4E3A;&#x4E86;&#x66F4;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;thunk&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;applyMiddleware&#x65F6;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F20;&#x5165;</span>
<span class="token comment">// &#x9ED8;&#x8BA4;&#x7684;thunk&#x662F;&#x6CA1;&#x6709;&#x989D;&#x5916;&#x53C2;&#x6570;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;thunk.withExtraArgument&#x65B9;&#x6CD5;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;thunk&#x6765;&#x4F20;&#x5165;&#x65B0;&#x7684;&#x53C2;&#x6570;&#x3002;</span>
<span class="token keyword">const</span> thunk <span class="token operator">=</span> <span class="token function">createThunkMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
thunk<span class="token punctuation">.</span>withExtraArgument <span class="token operator">=</span> createThunkMiddleware<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> thunk<span class="token punctuation">;</span>
</code></pre>
<p>&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x770B; redux-thunk &#x7684;&#x7528;&#x6CD5;&#xFF1A;</p>
<ol>
<li>&#x9996;&#x5148;&#x5B89;&#x88C5; redux-thunk&#xFF1A;</li>
</ol>
<pre class="language-"><code class="lang-bash"><span class="token function">npm</span> i -S redux-thunk
</code></pre>
<ol>
<li>&#x4FEE;&#x6539; store.js</li>
</ol>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// &#x7136;&#x540E;&#x9700;&#x8981;&#x4FEE;&#x6539;store.js&#x6587;&#x4EF6;&#xFF0C;&#x5BFC;&#x5165;applyMiddleware&#x5E76;&#x5C06;thunk&#x5E94;&#x7528;&#x5230;store</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token comment">// &#x521B;&#x5EFA;store&#x65F6;&#x5148;&#x4F7F;&#x7528;applyMiddleware&#x589E;&#x5F3A;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token comment">// &#x5982;&#x679C;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
  reducer<span class="token punctuation">,</span>
  <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">.</span><span class="token function">withExtraArgument</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token string">&apos;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ol>
<li>&#x9875;&#x9762;&#x8C03;&#x7528;</li>
</ol>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// &#x540C;&#x6B65;&#x51FD;&#x6570;</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">,</span> extraArgument</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x4EE5;action&#x7684;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">&apos;sync&apos;</span><span class="token punctuation">,</span>
    payload<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x5F02;&#x6B65;&#x51FD;&#x6570;</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">,</span> extraArgument</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;&#x770B;&#x770B;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;&apos;</span><span class="token punctuation">,</span> extraArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&apos;url&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// &#x7ECF;&#x8FC7;&#x8BA1;&#x7B97;&#x540E;&#x6D3E;&#x53D1;&#x4E00;&#x4E2A;&#x65B0;&#x7684;action</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&apos;async&apos;</span><span class="token punctuation">,</span>
      payload<span class="token operator">:</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> res<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ol>
<li>&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528; redux-thunk</li>
</ol>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// &#x4F7F;&#x7528;mapDispatchToProps&#x4E5F;&#x53EF;&#x4EE5;&#x8FBE;&#x6210;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;</span>
<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token string">&apos;sub&apos;</span><span class="token punctuation">,</span>
          payload<span class="token operator">:</span> value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x66FE;&#x7ECF;&#x4E5F;&#x56F0;&#x6270;&#x8FC7;&#x6211;&#xFF0C;&#x76F4;&#x5230;&#x6709;&#x4E00;&#x5929;&#x6211;&#x5728;<a href="https://stackoverflow.com/questions/35411423/how-to-dispatch-a-redux-action-with-a-timeout/35415559#35415559" target="_blank">stackoverflow &#x4E0A;&#x627E;&#x5230;&#x4E86;&#x8FD9;&#x7BC7;&#x5F97;&#x5230;&#x4E86;&#x5B98;&#x65B9;&#x63A8;&#x8350;&#x7684;&#x56DE;&#x7B54;</a>&#xFF1A;</p>
<blockquote>
<p><strong>&#x539F;&#x6587;</strong></p>
<p>Don&#x2019;t fall into the trap of thinking a library should prescribe how to do everything. If you want to do something with a timeout in JavaScript, you need to use . There is no reason why Redux actions should be any different.setTimeout</p>
<p>Redux does offer some alternative ways of dealing with asynchronous stuff, but you should only use those when you realize you are repeating too much code. Unless you have this problem, use what the language offers and go for the simplest solution.</p>
<p><strong>&#x8BD1;&#x6587;</strong></p>
<p><strong>&#x4E0D;&#x8981;&#x8BA4;&#x4E3A;&#x4E00;&#x4E2A;&#x5E93;&#x5E94;&#x8BE5;&#x89C4;&#x5B9A;&#x600E;&#x6837;&#x53BB;&#x505A;&#x6240;&#x6709;&#x7684;&#x4E8B;&#x60C5;&#x3002;</strong>&#x5982;&#x679C;&#x60A8;&#x60F3;&#x5728; JavaScript &#x4E2D;&#x5904;&#x7406;&#x5EF6;&#x65F6;&#x4EFB;&#x52A1;&#xFF0C;&#x76F4;&#x63A5;&#x4F7F;&#x7528; setTimeout &#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x3002;&#x6CA1;&#x6709;&#x7406;&#x7531;&#x8BA4;&#x4E3A; Redux &#x64CD;&#x4F5C;&#x5E94;&#x8BE5;&#x6709;&#x4EFB;&#x4F55;&#x4E0D;&#x540C;&#x3002;</p>
<p>Redux &#x786E;&#x5B9E;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x5F02;&#x6B65;&#x5185;&#x5BB9;&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x53EA;&#x6709;&#x5728;&#x60A8;&#x610F;&#x8BC6;&#x5230;&#x5728;&#x60A8;&#x7684;<strong>&#x9879;&#x76EE;&#x4E2D;&#x5B58;&#x5728;&#x4E86;&#x592A;&#x591A;&#x91CD;&#x590D;&#x7684;&#x4EE3;&#x7801;&#x65F6;</strong>&#x624D;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x3002;&#x5982;&#x679C;&#x60A8;&#x5E76;&#x6CA1;&#x6709;&#x592A;&#x591A;&#x91CD;&#x590D;&#x4EE3;&#x7801;&#xFF0C;&#x5EFA;&#x8BAE;&#x60A8;&#x91C7;&#x7528;&#x8BE5;&#x8BED;&#x8A00;&#x7684;&#x539F;&#x751F;&#x65B9;&#x6848;&#x4E5F;&#x8BB8;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;</p>
</blockquote>
<hr>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x8BDD;&#x6211;&#x5E0C;&#x671B;&#x4F60;&#x4EEC;&#x90FD;&#x4F1A;&#x7528;&#x5FC3;&#x53BB;&#x7406;&#x89E3;&#xFF0C;<strong>&#x5F88;&#x591A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x90FD;&#x9700;&#x8981;&#x8003;&#x8651;&#x505A;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#x7684;&#x6210;&#x672C;&#x4E0E;&#x5F97;&#x5230;&#x7684;&#x6548;&#x76CA;&#x662F;&#x5426;&#x5339;&#x914D;&#xFF0C;&#x5F53;&#x6210;&#x672C;&#x8D85;&#x8FC7;&#x6536;&#x76CA;&#x65F6;&#xFF0C;&#x5C31;&#x8981;&#x8003;&#x8651;&#x8FD9;&#x4EF6;&#x4E8B;&#x60C5;&#x8BE5;&#x4E0D;&#x8BE5;&#x505A;&#x4E86;</strong>&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x5F53;&#x4F60;&#x4EEC;&#x51B3;&#x5B9A;&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x4F7F;&#x7528; redux-thunk &#x65F6;&#xFF0C;&#x8BA4;&#x771F;&#x5730;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x771F;&#x7684;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5E93;&#xFF0C;&#x4E0D;&#x8981;&#x8F7B;&#x6613;&#x5730;&#x5F80;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x91CC;&#x5806;&#x780C;&#x592A;&#x591A;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x4F9D;&#x8D56;&#x3002;</p>
<p>&#x5230;&#x8FD9;&#x91CC;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x7684; redux-thunk &#x5C31;&#x7B97;&#x662F;&#x5B66;&#x4E60;&#x5B8C;&#x6210;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4EEC;&#x7684; redux &#x4E5F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x5730;&#x5904;&#x7406;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#x4E86;&#x3002;&#x4F46;&#x7A0B;&#x5E8F;&#x5458;&#x603B;&#x8BE5;&#x662F;&#x6709;&#x4E9B;&#x8FFD;&#x6C42;&#x7684;&#xFF0C;&#x603B;&#x4F1A;&#x60F3;&#x7740;&#x8981;&#x5B9E;&#x73B0;<strong>&#x66F4;&#x52A0;&#x4F18;&#x96C5;&#x7684;&#x65B9;&#x5F0F;</strong>&#x6765;&#x5B9E;&#x73B0; redux &#x5F02;&#x6B65;&#x6D41;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x53C8;&#x6709;&#x4E86; redux-promise &#x8FD9;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;</p>
<h4 id="redux-promise">redux-promise</h4>
<p>&#x4E0D;&#x540C;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x90FD;&#x6709;&#x7740;&#x81EA;&#x5DF1;&#x7684;&#x9002;&#x7528;&#x573A;&#x666F;&#xFF0C;redux-thunk &#x6BD4;&#x8F83;&#x9002;&#x5408;&#x7B80;&#x5355;&#x7684; API &#x8BF7;&#x6C42;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x800C; redux-promise &#x5219;&#x66F4;&#x52A0;&#x9002;&#x5408;&#x66F4;&#x590D;&#x6742;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x770B; redux-promise &#x7684;&#x539F;&#x7801;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token string">&apos;use strict&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// &#x4F7F;&#x7528;defineProperty&#x5F80;exports&#x91CC;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;__esModule&#x5C5E;&#x6027;</span>
<span class="token comment">// &#x8FD9;&#x4E00;&#x6B65;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x5728;&#x5F53;&#x524D;&#x73AF;&#x5883;&#x6B63;&#x786E;&#x5F15;&#x5165;is-promise&#x8FD9;&#x4E2A;&#x4F9D;&#x8D56;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">&apos;__esModule&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>default <span class="token operator">=</span> promiseMiddleware<span class="token punctuation">;</span>
<span class="token keyword">var</span> _isPromise <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;is-promise&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _fluxStandardAction <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;flux-standard-action&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>__esModule <span class="token operator">?</span> obj <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> obj <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_objectSpread</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> source <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ownKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>getOwnPropertySymbols <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ownKeys <span class="token operator">=</span> ownKeys<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>
        Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sym</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> sym<span class="token punctuation">)</span><span class="token punctuation">.</span>enumerable<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ownKeys<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">_defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_defineProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      value<span class="token operator">:</span> value<span class="token punctuation">,</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">promiseMiddleware</span><span class="token punctuation">(</span><span class="token parameter">_ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> dispatch <span class="token operator">=</span> _ref<span class="token punctuation">.</span>dispatch<span class="token punctuation">;</span>
  <span class="token comment">// dispatch&#x6216;&#x6D0B;&#x8471;&#x5708;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x8C03;&#x7528;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x6BD4;&#x8F83;&#x5C11;&#x89C1;&#xFF0C;&#x5B83;&#x7684;&#x672C;&#x8D28;&#x662F;javascript&#x4E2D;&#x7684;&#x9017;&#x53F7;&#x64CD;&#x4F5C;&#x7B26;</span>
      <span class="token comment">// &#x9017;&#x53F7;&#x64CD;&#x4F5C;&#x7B26;&#x7684;&#x529F;&#x80FD;&#x662F;&#x4ECE;&#x5DE6;&#x81F3;&#x53F3;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x6C42;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x5BF9;&#x8C61;&#x7684;&#x503C;</span>
      <span class="token comment">// &#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x7684;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x5C06;&#x540E;&#x9762;&#x7684;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8F6C;&#x6362;&#x6210;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7136;&#x540E;&#x8C03;&#x7528;&#x5E76;&#x4F20;&#x5165;&#x4E0B;&#x4E00;&#x4E2A;&#x62EC;&#x53F7;&#x4E2D;&#x7684;&#x53C2;&#x6570;</span>
      <span class="token comment">// &#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x6837;&#x5199;&#x5462;&#xFF1F;</span>
      <span class="token comment">// &#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x7684;&#x76EE;&#x7684;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;this&#x6307;&#x5411;&#xFF0C;&#x7136;&#x800C;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;call&#x6216;apply&#xFF0C;&#x8FD9;&#x91CC;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x4F7F;&#x7528;&#x5462;&#xFF1F;</span>
      <span class="token comment">// &#x56E0;&#x4E3A;&#x6709;&#x7684;&#x65F6;&#x5019;&#x6709;&#x4E9B;&#x7A0B;&#x5E8F;&#x5458;&#x4E60;&#x60EF;&#x4E8E;&#x4FEE;&#x6539;prototype&#xFF0C;&#x5C06;call&#x6216;apply&#x6307;&#x5411;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x751A;&#x81F3;&#x6539;&#x53D8;prototype&#x7684;&#x6307;&#x5411;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x539F;&#x578B;&#x94FE;&#x4E0A;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x53EF;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x597D;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;</span>
      <span class="token comment">// &#x6240;&#x4EE5;&#xFF0C;&#x4E3A;&#x4E86;&#x80FD;&#x8BA9;&#x81EA;&#x5DF1;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x8BFB;&#x6027;&#x66F4;&#x9AD8;&#xFF0C;&#x4E0D;&#x5F71;&#x54CD;&#x5176;&#x5B83;&#x7A0B;&#x5E8F;&#x7684;&#x6B63;&#x5E38;&#x6267;&#x884C;&#xFF0C;&#x5F00;&#x53D1;&#x4E2D;&#x6211;&#x4EEC;&#x5343;&#x4E07;&#x4E0D;&#x8981;&#x53BB;&#x4FEE;&#x6539;&#x539F;&#x578B;&#x94FE;&#xFF01;</span>

      <span class="token comment">// &#x9996;&#x5148;&#xFF0C;&#x5224;&#x65AD;&#x6574;&#x4E2A;action&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;flux&#x683C;&#x5F0F;&#x7684;action</span>
      <span class="token comment">// flux&#x683C;&#x5F0F;&#x7684;action&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6709;type&#x548C;payload&#x7684;&#x5BF9;&#x8C61;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _fluxStandardAction<span class="token punctuation">.</span>isFSA<span class="token punctuation">)</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &#x5982;&#x679C;&#x4E0D;&#x662F;flux&#x7684;action,&#x90A3;&#x4E48;&#x5C31;&#x5224;&#x65AD;&#x5B83;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;promise&#x5BF9;&#x8C61;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _isPromise<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
          <span class="token operator">?</span> <span class="token comment">// &#x662F;promise&#x5BF9;&#x8C61;&#xFF0C;&#x6267;&#x884C;&#x5B83;</span>
            action<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span>
          <span class="token operator">:</span> <span class="token comment">// &#x4E0D;&#x662F;promise&#x5BF9;&#x8C61;&#xFF0C;&#x4EA4;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x8FDB;&#x884C;&#x5904;&#x7406;</span>
            <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// &#x5224;&#x65AD;action&#x7684;payload&#x5C5E;&#x6027;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;promise&#x5BF9;&#x8C61;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _isPromise<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span>
        <span class="token operator">?</span> <span class="token comment">// &#x662F;promise&#x5BF9;&#x8C61;&#xFF0C;&#x6267;&#x884C;&#x5B83;</span>
          action<span class="token punctuation">.</span>payload
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// &#x83B7;&#x5F97;&#x7ED3;&#x679C;&#x540E;&#x4F7F;&#x7528;dispatch&#x6D3E;&#x53D1;&#x5305;&#x542B;&#x6709;&#x7ED3;&#x679C;&#x548C;&#x5F53;&#x524D;action&#x7684;&#x65B0;&#x5BF9;&#x8C61;</span>
              <span class="token keyword">return</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>
                <span class="token function">_objectSpread</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                  payload<span class="token operator">:</span> result<span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">dispatch</span><span class="token punctuation">(</span>
                <span class="token function">_objectSpread</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                  payload<span class="token operator">:</span> error<span class="token punctuation">,</span>
                  error<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token comment">// &#x5426;&#x5219;&#xFF0C;&#x4E22;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x8FDB;&#x884C;&#x5904;&#x7406;</span>
          <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;redux-promise &#x76F8;&#x5BF9;&#x4E8E; redux-thunk &#x6765;&#x8BF4;&#x5BF9;&#x5E94;&#x7684;&#x573A;&#x666F;&#x66F4;&#x52A0;&#x7CBE;&#x51C6;&#xFF0C;&#x5B83;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x6790; promise &#x5BF9;&#x8C61;&#x800C;&#x751F;&#x7684;&#xFF1A;</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment">// &#x9875;&#x9762;</span>
<span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &#x6D3E;&#x53D1;&#x4E00;&#x4E2A;action</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token string">&apos;getInfo&apos;</span><span class="token punctuation">,</span>
          <span class="token comment">// payload&#x662F;&#x4E00;&#x4E2A;axios&#x8FD4;&#x56DE;&#x7684;promise&#x5BF9;&#x8C61;</span>
          payload<span class="token operator">:</span> Sapi<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&apos;/adminapi/login/info&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>
  <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>getInfo<span class="token punctuation">}</span><span class="token operator">&gt;</span>&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reducer</span>
<span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x5339;&#x914D;&#x5230;type</span>
    <span class="token keyword">case</span> <span class="token string">&apos;getInfo&apos;</span><span class="token operator">:</span>
      <span class="token comment">// &#x4F7F;&#x7528;&#x5C55;&#x5F00;&#x8FD0;&#x7B97;&#x7B26;&#x5408;&#x5E76;state&#x548C;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x6570;&#x636E;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>payload <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="redux-saga">redux-saga</h4>
<p>redux-saga&#xFF0C;&#x76F8;&#x6BD4;&#x8D77; thunk &#x548C; promise &#x6765;&#x8BF4;&#xFF0C;&#x5B83;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x662F;&#x62E5;&#x6709;&#x590D;&#x6742;&#x7684;&#x5F02;&#x6B65;&#x9700;&#x6C42;&#xFF0C;&#x5BF9;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x8981;&#x6C42;&#x7279;&#x522B;&#x9AD8;&#x7684;&#x5927;&#x578B;&#x6216;&#x8D85;&#x5927;&#x578B;&#x9879;&#x76EE;&#x3002;&#x56E0;&#x4E3A; saga &#x5165;&#x95E8;&#x77E5;&#x8BC6;&#x76F8;&#x5BF9;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x96BE;&#x4E0A;&#x624B;&#xFF0C;&#x800C;&#x4E14;&#x76EE;&#x524D;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x5728; dva &#x5E93;&#x6216; umi &#x6846;&#x67B6;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x8FB9;&#x6682;&#x65F6;&#x5148;&#x4E0D;&#x8BB2;&#x8FD9;&#x5757;&#xFF0C;&#x5230;&#x4E86;&#x7B2C;&#x4E94;&#x5355;&#x5143; Umi &#x7684;&#x65F6;&#x5019;&#x518D;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x3002;</p>
<footer class="footer"><div class="footer__container--normal"><div class="footer__description--normal"><p class="paragraph footer__author--normal" style="color: #000 !important;">&#x524D;&#x7AEF;&#x7B14;&#x8BB0;<sup class="super">&#xAE;</sup></p><p class="paragraph footer__quote--normal" style="color: #000 !important;">&#x81F4;&#x6240;&#x6709;&#x60F3;&#x8981;&#x8FDB;&#x5165;&#x524D;&#x7AEF;&#x5F00;&#x53D1;&#x884C;&#x4E1A;&#x7684;&#x65B0;&#x4EBA;&#x4EEC;  -- marion.lau</p><div class="footer__main--normal"><p class="paragraph footer__main__paragraph--normal copyright" style="color: #666 !important;">Copyright &#xA9; marion.lau@foxmail.com all right reserved</p><p class="paragraph footer__main__paragraph--normal footer__modifyTime--normal" style="color: #666 !important;"><span style="color: #666 !important;">modified at</span>
2022-08-31 09:32:12
</p></div></div></div><div id="gitalk-container" class="box__issues"></div><link rel="stylesheet" href="../assets/gitalk.min.css"><script src="../assets/gitalk.min.js"></script><script>var gitalk = new Gitalk({clientID: "1dd340a7923ebd556673",clientSecret: "4981d6b240efb08d88e19b395d3b7ea12300e0ec",repo: "blog.fenotes.com",owner: "uncle-marion",admin: ["uncle-marion"],id: location.pathname});gitalk.render("gitalk-container");</script></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="container.fun.html" class="navigation navigation-prev " aria-label="Previous page: 项目实战 完善全局框架">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="devtools.html" class="navigation navigation-next " aria-label="Next page: 附录 2 调试工具与状态持久化">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"附录 1 applyMiddleware 与常用中间件","level":"1.3.5.3","depth":3,"next":{"title":"附录 2 调试工具与状态持久化","level":"1.3.5.4","depth":3,"path":"unit2/devtools.md","ref":"unit2/devtools.md","articles":[]},"previous":{"title":"项目实战 完善全局框架","level":"1.3.5.2","depth":3,"path":"unit2/container.fun.md","ref":"unit2/container.fun.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","prism","-highlight","page-copyright","custom-favicon","katex","livereload"],"styles":{"website":"./assets/style.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"livereload":{},"search":{},"page-copyright":{"wisdom":"致所有想要进入前端开发行业的新人们  -- marion.lau","noPowered":true,"clientID":"1dd340a7923ebd556673","copyright":"Copyright &#169; marion.lau@foxmail.com","styles (normal, symmetrical)":"normal","style":"normal","isShowQRCode":false,"timeColor":"#666","utcOffset":"8","format":"YYYY-MM-dd hh:mm:ss","signature":"前端笔记","baseUri":"http://www.fenotes.com","clientSecret":"4981d6b240efb08d88e19b395d3b7ea12300e0ec","copyrightColor":"#666","description":"modified at"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":"./assets/m.png","custom-favicon":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","author":"marion.lau@foxmail.com","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"平安蜀黍的前端教程","gitbook":"*","description":"从运行环境到代码编辑，从react基础知识与项目搭建开始，引导学员逐步熟悉javascript与typescript，在教程的后期，还介绍了Nodejs、Vue、Uniapp等前端程序员必须了解的知识点","theme-default":{"showLevel":true}},"file":{"path":"unit2/middleware.md","mtime":"2022-08-31T01:32:12.257Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-08-31T10:20:13.160Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

